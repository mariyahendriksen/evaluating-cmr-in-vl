#!/bin/bash
#SBATCH -t 04:00:00
#SBATCH -N 1
#SBATCH --cpus-per-task=10
#SBATCH --mem=50gb
#SBATCH --gpus=1
#SBATCH --partition=gpu
#SBATCH -o ./src/logs/eval_missing_jobs_f30k.out

DATASET=f30k
echo 'Dataset: ' $DATASET
MODEL=altclip
declare -a PERTURBATIONS=(
    "char_swap"
    "missing_char"
    "extra_char"
    "probability_based_letter_change"
    "synonym_noun"
    "distraction_true"
    "distraction_false"
    )
for PERTURBATION in "${PERTURBATIONS[@]}"
do
   echo MODEL: $MODEL
   CUDA_VISIBLE_DEVICES=$CUDA_VISIBLE_DEVICES python src/evaluation.py \
    --dataset $DATASET \
    --model $MODEL \
    --perturbation $PERTURBATION \
    --task t2i
done


MODEL=align
declare -a PERTURBATIONS=(
    "char_swap"
    "missing_char"
    "extra_char"
    "probability_based_letter_change"
    "synonym_noun"
    "synonym_adj"
    "distraction_true"
    "distraction_false"
    "shuffle_all_words"
    "shuffle_allbut_nouns_and_adj"
    "shuffle_within_trigrams"
    "shuffle_trigrams"
    )
for PERTURBATION in "${PERTURBATIONS[@]}"
do
   echo MODEL: $MODEL
   CUDA_VISIBLE_DEVICES=$CUDA_VISIBLE_DEVICES python src/evaluation.py \
    --dataset $DATASET \
    --model $MODEL \
    --perturbation $PERTURBATION \
    --task t2i
done


MODEL=clip
declare -a PERTURBATIONS=(
    "extra_char"
    "probability_based_letter_change"
    )
for PERTURBATION in "${PERTURBATIONS[@]}"
do
   echo MODEL: $MODEL
   CUDA_VISIBLE_DEVICES=$CUDA_VISIBLE_DEVICES python src/evaluation.py \
    --dataset $DATASET \
    --model $MODEL \
    --perturbation $PERTURBATION \
    --task t2i
done


MODEL=groupvit
declare -a PERTURBATIONS=(
    "char_swap"
    "missing_char"
    "extra_char"
    "probability_based_letter_change"
    "synonym_noun"
    "distraction_true"
    )
for PERTURBATION in "${PERTURBATIONS[@]}"
do
   echo MODEL: $MODEL
   CUDA_VISIBLE_DEVICES=$CUDA_VISIBLE_DEVICES python src/evaluation.py \
    --dataset $DATASET \
    --model $MODEL \
    --perturbation $PERTURBATION \
    --task t2i
done
